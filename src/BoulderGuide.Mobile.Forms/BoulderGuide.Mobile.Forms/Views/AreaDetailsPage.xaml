<?xml version="1.0" encoding="utf-8" ?>
<TabbedPage xmlns="http://xamarin.com/schemas/2014/forms"
            xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
            xmlns:prism="http://prismlibrary.com"
            xmlns:root="clr-namespace:BoulderGuide.Mobile.Forms"
            xmlns:converters="clr-namespace:BoulderGuide.Mobile.Forms.Converters"
            prism:ViewModelLocator.AutowireViewModel="True"
            x:Class="BoulderGuide.Mobile.Forms.Views.AreaDetailsPage"
            BarBackgroundColor="{StaticResource Primary}"
            Title="{Binding Info.Name}">

   <TabbedPage.Resources>
      <converters:ValueToVisibilityConverter x:Key="valueToVisibility" />
      <converters:LengthConverter x:Key="lengthConverter" />
   </TabbedPage.Resources>

   <TabbedPage.ToolbarItems>
      <ToolbarItem Text="{Binding Source={Static root:Strings.Map}}" Command="{Binding MapCommand}" />
      <ToolbarItem Text="{Binding Source={Static root:Strings.Download}}" Command="{Binding DownloadCommand}" />
   </TabbedPage.ToolbarItems>

   <ContentPage
      Title="{Binding Source={Static root:Strings.AreaContent}}">
      <ScrollView>
         <Grid>
            <ActivityIndicator
               IsRunning="{Binding IsLoading}"
               IsVisible="{Binding IsLoading}"
               HorizontalOptions="Center"
               VerticalOptions="CenterAndExpand"
               Color="Gray"
               BackgroundColor="#99111111"/>

            <StackLayout>

               <Label Text="{Binding Source={Static root:Strings.Areas}}"
                   IsVisible="{Binding Info.HasAreas}"
                   HorizontalOptions="CenterAndExpand"
                   FontSize="Large"
                   Margin="0, 10, 0, 0"/>
               <ListView ItemsSource="{Binding Info.Areas}"
                      SelectedItem="{Binding SelectedAreaInfo}"
                      IsVisible="{Binding Info.HasAreas}"
                      Margin="10">
                  <ListView.ItemTemplate>
                     <DataTemplate>
                        <ViewCell>
                           <Grid>
                              <Grid.ColumnDefinitions>
                                 <ColumnDefinition Width="Auto" />
                                 <ColumnDefinition Width="*" />
                                 <ColumnDefinition Width="Auto" />
                              </Grid.ColumnDefinitions>

                              <Label Text="{Binding Name}" VerticalOptions="CenterAndExpand" Margin="10, 0, 0, 0"/>

                              <StackLayout Grid.Column="2" Orientation="Horizontal">
                                 <Label
                           Text="{Binding Areas, Converter={StaticResource Key=lengthConverter}}"
                           VerticalOptions="CenterAndExpand"
                           FontSize="Micro" />
                                 <Label
                           Text="/"
                           VerticalOptions="CenterAndExpand"
                           FontSize="Micro" />
                                 <Label
                           Text="{Binding Routes, Converter={StaticResource Key=lengthConverter}}"
                           VerticalOptions="CenterAndExpand"
                           FontSize="Micro" />
                              </StackLayout>
                           </Grid>
                        </ViewCell>
                     </DataTemplate>
                  </ListView.ItemTemplate>
               </ListView>

               <Label Text="{Binding Source={Static root:Strings.Routes}}"
                   IsVisible="{Binding Info.HasRoutes}"
                   HorizontalOptions="CenterAndExpand"
                   FontSize="Large"
                   Margin="0, 10, 0, 0" />
               <ListView ItemsSource="{Binding Info.Routes}"
                      Margin="10"
                      IsVisible="{Binding Info.HasRoutes}"
                      SelectedItem="{Binding SelectedRouteInfo}">
                  <ListView.ItemTemplate>
                     <DataTemplate>
                        <ViewCell>
                           <Grid>
                              <Grid.ColumnDefinitions>
                                 <ColumnDefinition Width="Auto" />
                                 <ColumnDefinition Width="*" />
                                 <ColumnDefinition Width="Auto" />
                              </Grid.ColumnDefinitions>

                              <Label
                              Text="{Binding Name}"
                              VerticalOptions="CenterAndExpand"
                              Margin="10, 0, 0, 0"/>

                              <Label
                              Text="{Binding Grade, StringFormat='({0})'}"
                              VerticalOptions="CenterAndExpand"
                              Grid.Column="2"
                              FontSize="Micro" />
                           </Grid>
                        </ViewCell>
                     </DataTemplate>
                  </ListView.ItemTemplate>
               </ListView>
            </StackLayout>

         </Grid>
      </ScrollView>

   </ContentPage>

   <ContentPage Title="{Binding Source={Static root:Strings.Info}}">
      <ScrollView>
         <StackLayout>
            <ActivityIndicator
               IsRunning="{Binding IsLoading}"
               IsVisible="{Binding IsLoading}"
               HorizontalOptions="Center"
               VerticalOptions="Center"
               Color="Gray"/>
            <Label Text="{Binding Source={Static root:Strings.AreaInfo}}" />
            <Label Text="{Binding Area.Info}" />

            <Label Text="{Binding Source={Static root:Strings.AreaAccess}}"
                   IsVisible="{Binding Area.Access, Converter={StaticResource Key=valueToVisibility}}" />
            <Label Text="{Binding Area.Access}"
                   IsVisible="{Binding Area.Access, Converter={StaticResource Key=valueToVisibility}}" />
            <Label Text="{Binding Source={Static root:Strings.AreaHistory}}"
                   IsVisible="{Binding Area.History, Converter={StaticResource Key=valueToVisibility}}" />
            <Label Text="{Binding Area.History}"
                   IsVisible="{Binding Area.History, Converter={StaticResource Key=valueToVisibility}}" />
            <Label Text="{Binding Source={Static root:Strings.AreaEthics}}"
                   IsVisible="{Binding Area.Ethics, Converter={StaticResource Key=valueToVisibility}}" />
            <Label Text="{Binding Area.Ethics}"
                   IsVisible="{Binding Area.Ethics, Converter={StaticResource Key=valueToVisibility}}" />
            <Label Text="{Binding Source={Static root:Strings.AreaAccommodations}}"
                   IsVisible="{Binding Area.Accommodations, Converter={StaticResource Key=valueToVisibility}}" />
            <Label Text="{Binding Area.Accommodations}"
                   IsVisible="{Binding Area.Accommodations, Converter={StaticResource Key=valueToVisibility}}" />
            <Label Text="{Binding Source={Static root:Strings.AreaRestrictions}}"
                   IsVisible="{Binding Area.Restrictions, Converter={StaticResource Key=valueToVisibility}}" />
            <Label Text="{Binding Area.Restrictions}"
                   IsVisible="{Binding Area.Restrictions, Converter={StaticResource Key=valueToVisibility}}" />
         </StackLayout>
      </ScrollView>
   </ContentPage>

</TabbedPage>